<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å–ç‚¹æç‚¼å™¨ - AIå¸®ä½ å¿«é€Ÿæç‚¼äº§å“æ ¸å¿ƒå–ç‚¹</title>
  <meta name="description" content="è¾“å…¥ä½ çš„äº§å“æè¿°ï¼ŒAIå¸®ä½ æç‚¼ä»·å€¼ä¸»å¼ ã€æ ¸å¿ƒå–ç‚¹ã€ç”¨æˆ·ç”»åƒã€ç”µæ¢¯æ¼”è®²ç¨¿å’Œæœ‹å‹åœˆæ–‡æ¡ˆ">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in-up {
      animation: fadeInUp 0.5s ease-out forwards;
    }
    .result-card:nth-child(2) { animation-delay: 0.1s; }
    .result-card:nth-child(3) { animation-delay: 0.2s; }
    .result-card:nth-child(4) { animation-delay: 0.3s; }
    .result-card:nth-child(5) { animation-delay: 0.4s; }

    @keyframes pulse-dot {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }
    .loading-dot {
      display: inline-block;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #6366f1;
      animation: pulse-dot 1.4s infinite ease-in-out;
    }
    .loading-dot:nth-child(1) { animation-delay: -0.32s; }
    .loading-dot:nth-child(2) { animation-delay: -0.16s; }

    .char-count { transition: color 0.2s; }

    .copy-btn {
      opacity: 0;
      transition: opacity 0.2s;
    }
    .result-card:hover .copy-btn {
      opacity: 1;
    }
    @media (hover: none) {
      .copy-btn { opacity: 1; }
    }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div class="max-w-2xl mx-auto px-4 py-8 sm:py-12">

    <!-- Header -->
    <header class="text-center mb-8">
      <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-2">å–ç‚¹æç‚¼å™¨</h1>
      <p class="text-gray-500 text-lg">AI å¸®ä½ å¿«é€Ÿæç‚¼äº§å“æ ¸å¿ƒå–ç‚¹</p>
    </header>

    <!-- Input Section -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6">
      <!-- Example Buttons -->
      <div class="flex gap-2 mb-4">
        <button onclick="fillExample(0)" class="example-btn text-sm px-3 py-1.5 rounded-full border border-gray-200 text-gray-600 hover:border-indigo-300 hover:text-indigo-600 hover:bg-indigo-50 transition-colors">
          ğŸ’¡ è¯•è¯•ï¼šAIè‡ªåŠ¨åŒ–å’¨è¯¢
        </button>
        <button onclick="fillExample(1)" class="example-btn text-sm px-3 py-1.5 rounded-full border border-gray-200 text-gray-600 hover:border-indigo-300 hover:text-indigo-600 hover:bg-indigo-50 transition-colors">
          ğŸ’… è¯•è¯•ï¼šæ‰‹å·¥ç©¿æˆ´ç”²
        </button>
      </div>

      <!-- Textarea -->
      <div class="relative">
        <textarea
          id="input"
          rows="4"
          maxlength="500"
          placeholder="æè¿°ä½ çš„äº§å“æˆ–æœåŠ¡ï¼Œæ¯”å¦‚ï¼šæˆ‘åšç©¿æˆ´ç”²å®šåˆ¶ï¼Œä¸»æ‰“æ‰‹ç»˜è®¾è®¡..."
          class="w-full px-4 py-3 border border-gray-200 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-gray-800 placeholder-gray-400 text-base leading-relaxed"
          oninput="updateCharCount()"
        ></textarea>
        <span id="charCount" class="char-count absolute bottom-3 right-3 text-xs text-gray-400">0/500</span>
      </div>

      <!-- Submit Button -->
      <button
        id="submitBtn"
        onclick="generate()"
        class="w-full mt-4 py-3 px-6 bg-indigo-600 hover:bg-indigo-700 text-white font-medium rounded-xl transition-colors text-base disabled:opacity-50 disabled:cursor-not-allowed"
      >
        âœ¨ æç‚¼å–ç‚¹
      </button>
    </div>

    <!-- Loading -->
    <div id="loading" class="hidden text-center py-12">
      <div class="mb-4">
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
        <span class="loading-dot"></span>
      </div>
      <p id="loadingText" class="text-gray-500">AI æ­£åœ¨åˆ†æä½ çš„äº§å“...</p>
    </div>

    <!-- Error -->
    <div id="error" class="hidden bg-red-50 border border-red-200 rounded-xl p-4 mb-6 text-red-600 text-sm"></div>

    <!-- Results -->
    <div id="results" class="hidden space-y-4">

      <!-- ä»·å€¼ä¸»å¼  -->
      <div class="result-card fade-in-up opacity-0 bg-white rounded-2xl shadow-sm border border-gray-200 p-6 relative">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ’</span>
            <h2 class="font-semibold text-gray-800">ä¸€å¥è¯ä»·å€¼ä¸»å¼ </h2>
          </div>
          <button onclick="copyCard(this, 'r-value')" class="copy-btn text-xs text-gray-400 hover:text-indigo-600 px-2 py-1 rounded-md hover:bg-indigo-50 transition-colors">å¤åˆ¶</button>
        </div>
        <p id="r-value" class="text-xl font-medium text-indigo-700 leading-relaxed"></p>
      </div>

      <!-- æ ¸å¿ƒå–ç‚¹ -->
      <div class="result-card fade-in-up opacity-0 bg-white rounded-2xl shadow-sm border border-gray-200 p-6 relative">
        <div class="flex items-center justify-between mb-4">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ¯</span>
            <h2 class="font-semibold text-gray-800">æ ¸å¿ƒå–ç‚¹</h2>
          </div>
          <button onclick="copyCard(this, 'r-points')" class="copy-btn text-xs text-gray-400 hover:text-indigo-600 px-2 py-1 rounded-md hover:bg-indigo-50 transition-colors">å¤åˆ¶</button>
        </div>
        <div id="r-points" class="space-y-3"></div>
      </div>

      <!-- ç›®æ ‡ç”¨æˆ· -->
      <div class="result-card fade-in-up opacity-0 bg-white rounded-2xl shadow-sm border border-gray-200 p-6 relative">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ‘¤</span>
            <h2 class="font-semibold text-gray-800">ç›®æ ‡ç”¨æˆ·ç”»åƒ</h2>
          </div>
          <button onclick="copyCard(this, 'r-user')" class="copy-btn text-xs text-gray-400 hover:text-indigo-600 px-2 py-1 rounded-md hover:bg-indigo-50 transition-colors">å¤åˆ¶</button>
        </div>
        <p id="r-user" class="text-gray-700 leading-relaxed"></p>
      </div>

      <!-- ç”µæ¢¯æ¼”è®² -->
      <div class="result-card fade-in-up opacity-0 bg-white rounded-2xl shadow-sm border border-gray-200 p-6 relative">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ¤</span>
            <h2 class="font-semibold text-gray-800">30ç§’ç”µæ¢¯æ¼”è®²</h2>
          </div>
          <button onclick="copyCard(this, 'r-pitch')" class="copy-btn text-xs text-gray-400 hover:text-indigo-600 px-2 py-1 rounded-md hover:bg-indigo-50 transition-colors">å¤åˆ¶</button>
        </div>
        <p id="r-pitch" class="text-gray-700 leading-relaxed"></p>
      </div>

      <!-- æœ‹å‹åœˆæ–‡æ¡ˆ -->
      <div class="result-card fade-in-up opacity-0 bg-white rounded-2xl shadow-sm border border-gray-200 p-6 relative">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-lg">ğŸ“±</span>
            <h2 class="font-semibold text-gray-800">æœ‹å‹åœˆæ–‡æ¡ˆ</h2>
          </div>
          <button onclick="copyCard(this, 'r-wechat')" class="copy-btn text-xs text-gray-400 hover:text-indigo-600 px-2 py-1 rounded-md hover:bg-indigo-50 transition-colors">å¤åˆ¶</button>
        </div>
        <p id="r-wechat" class="text-gray-700 leading-relaxed whitespace-pre-line"></p>
      </div>

      <!-- Copy All Button -->
      <button
        onclick="copyAll()"
        class="w-full py-3 px-6 bg-gray-900 hover:bg-gray-800 text-white font-medium rounded-xl transition-colors text-base"
      >
        ğŸ“‹ ä¸€é”®å¤åˆ¶å…¨éƒ¨ç»“æœ
      </button>

      <!-- CTA -->
      <div class="bg-white rounded-2xl border border-gray-100 p-5 flex items-center gap-4">
        <div class="flex-shrink-0 bg-white rounded-xl p-2 border border-gray-100">
          <img src="qrcode.png" alt="å¾®ä¿¡äºŒç»´ç " class="w-20 h-20 object-contain"
               onerror="this.parentElement.parentElement.style.display='none'" />
        </div>
        <div>
          <p class="text-sm font-medium text-gray-700 mb-0.5">æƒ³å­¦ç”¨ AI åšè¿™æ ·çš„å·¥å…·ï¼Ÿ</p>
          <p class="text-xs text-gray-400">æ‰«ç åŠ å¾®ä¿¡ï¼Œå‘é€ã€Œå–ç‚¹ã€é¢†å–ã€Šä¸€äººå…¬å¸å•†ä¸šåŒ…è£…æŒ‡å—ã€‹</p>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="text-center mt-12 text-sm text-gray-400">
      Powered by æ˜ŸèŠ’AI Â· Vibe Coding æ¼”ç¤ºé¡¹ç›®
    </footer>
  </div>

  <script>
    const examples = [
      'æˆ‘åšAIè‡ªåŠ¨åŒ–å’¨è¯¢ï¼Œå¸®ä¸­å°ä¼ä¸šç”¨AIå·¥å…·æ›¿ä»£é‡å¤æ€§å·¥ä½œï¼Œé™ä½äººåŠ›æˆæœ¬ï¼Œä¸€ä¸ªäººå°±èƒ½æœåŠ¡50å®¶å®¢æˆ·',
      'æˆ‘å–æ‰‹å·¥ç©¿æˆ´ç”²ï¼Œä¸»æ‰“åŸåˆ›æ‰‹ç»˜è®¾è®¡ï¼Œå¯ä»¥æ ¹æ®å®¢æˆ·å–œå¥½å®šåˆ¶å›¾æ¡ˆï¼Œæ¯”ç¾ç”²åº—ä¾¿å®œä¸€åŠè¿˜èƒ½åå¤ä½¿ç”¨'
    ];

    // loading æ–‡æ¡ˆè½®æ’­
    const loadingTexts = [
      'AI æ­£åœ¨åˆ†æä½ çš„äº§å“...',
      'æ­£åœ¨æç‚¼æ ¸å¿ƒå–ç‚¹...',
      'æ­£åœ¨æ’°å†™ç”µæ¢¯æ¼”è®²ç¨¿...',
      'æ­£åœ¨æ‰“ç£¨æœ‹å‹åœˆæ–‡æ¡ˆ...',
      'é©¬ä¸Šå°±å¥½...'
    ];
    let loadingTimer = null;

    function startLoadingTexts() {
      let idx = 0;
      const el = document.getElementById('loadingText');
      el.textContent = loadingTexts[0];
      loadingTimer = setInterval(() => {
        idx++;
        if (idx < loadingTexts.length) {
          el.textContent = loadingTexts[idx];
        }
      }, 3000);
    }

    function stopLoadingTexts() {
      if (loadingTimer) {
        clearInterval(loadingTimer);
        loadingTimer = null;
      }
    }

    function fillExample(i) {
      const input = document.getElementById('input');
      input.value = examples[i];
      updateCharCount();
      input.focus();
    }

    function updateCharCount() {
      const input = document.getElementById('input');
      const count = document.getElementById('charCount');
      const len = input.value.length;
      count.textContent = `${len}/500`;
      count.style.color = len > 450 ? '#ef4444' : len > 350 ? '#f59e0b' : '#9ca3af';
    }

    async function generate() {
      const input = document.getElementById('input');
      const description = input.value.trim();

      if (!description) {
        showError('è¯·å…ˆè¾“å…¥ä½ çš„äº§å“æˆ–æœåŠ¡æè¿°');
        return;
      }

      const btn = document.getElementById('submitBtn');
      const loading = document.getElementById('loading');
      const results = document.getElementById('results');
      const error = document.getElementById('error');

      // é‡ç½®çŠ¶æ€ï¼šéšè—æ—§ç»“æœå’Œé”™è¯¯
      btn.disabled = true;
      btn.textContent = 'æç‚¼ä¸­...';
      results.classList.add('hidden');
      error.classList.add('hidden');
      loading.classList.remove('hidden');
      startLoadingTexts();

      try {
        const res = await fetch('/api/generate', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ description })
        });

        const data = await res.json();

        if (!res.ok) {
          throw new Error(data.error || 'è¯·æ±‚å¤±è´¥');
        }

        renderResults(data.result);
      } catch (err) {
        showError(err.message || 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
      } finally {
        btn.disabled = false;
        btn.textContent = 'âœ¨ å†æ¥ä¸€æ¬¡';
        stopLoadingTexts();
        loading.classList.add('hidden');
      }
    }

    function renderResults(r) {
      // ä»·å€¼ä¸»å¼ 
      document.getElementById('r-value').textContent = r.valueProposition;

      // æ ¸å¿ƒå–ç‚¹
      const pointsEl = document.getElementById('r-points');
      pointsEl.innerHTML = r.sellingPoints.map((p, i) => `
        <div class="flex gap-3 items-start">
          <span class="flex-shrink-0 w-7 h-7 rounded-lg bg-indigo-100 text-indigo-600 flex items-center justify-center text-sm font-semibold">${i + 1}</span>
          <div>
            <span class="font-semibold text-gray-800">${escapeHtml(p.title)}</span>
            <span class="text-gray-500 ml-1">â€”</span>
            <span class="text-gray-600 ml-1">${escapeHtml(p.description)}</span>
          </div>
        </div>
      `).join('');

      // ç›®æ ‡ç”¨æˆ·
      document.getElementById('r-user').textContent = r.targetUser;

      // ç”µæ¢¯æ¼”è®²
      document.getElementById('r-pitch').textContent = r.elevatorPitch;

      // æœ‹å‹åœˆæ–‡æ¡ˆ
      document.getElementById('r-wechat').textContent = r.wechatCopy;

      // é‡ç½®åŠ¨ç”»
      document.querySelectorAll('.result-card').forEach(card => {
        card.style.animation = 'none';
        card.offsetHeight;
        card.style.animation = '';
      });

      document.getElementById('results').classList.remove('hidden');

      // æ»šåŠ¨åˆ°ç»“æœåŒºç¬¬ä¸€å¼ å¡ç‰‡
      setTimeout(() => {
        document.querySelector('.result-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    }

    function showError(msg) {
      const error = document.getElementById('error');
      error.textContent = msg;
      error.classList.remove('hidden');
    }

    function escapeHtml(str) {
      const div = document.createElement('div');
      div.textContent = str;
      return div.innerHTML;
    }

    // å•å¡ç‰‡å¤åˆ¶
    async function copyCard(btn, elementId) {
      const text = document.getElementById(elementId).textContent.trim();
      try {
        await navigator.clipboard.writeText(text);
        const orig = btn.textContent;
        btn.textContent = 'å·²å¤åˆ¶';
        btn.classList.add('text-indigo-600');
        setTimeout(() => { btn.textContent = orig; btn.classList.remove('text-indigo-600'); }, 1500);
      } catch {
        fallbackCopy(text);
      }
    }

    // å…¨éƒ¨å¤åˆ¶
    async function copyAll() {
      const r = {
        value: document.getElementById('r-value').textContent,
        points: document.getElementById('r-points').textContent.trim(),
        user: document.getElementById('r-user').textContent,
        pitch: document.getElementById('r-pitch').textContent,
        wechat: document.getElementById('r-wechat').textContent
      };

      const text = `ğŸ’ ä»·å€¼ä¸»å¼ 
${r.value}

ğŸ¯ æ ¸å¿ƒå–ç‚¹
${r.points}

ğŸ‘¤ ç›®æ ‡ç”¨æˆ·
${r.user}

ğŸ¤ 30ç§’ç”µæ¢¯æ¼”è®²
${r.pitch}

ğŸ“± æœ‹å‹åœˆæ–‡æ¡ˆ
${r.wechat}`;

      try {
        await navigator.clipboard.writeText(text);
        const btn = event.target.closest('button');
        const original = btn.textContent;
        btn.textContent = 'âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿';
        setTimeout(() => btn.textContent = original, 2000);
      } catch {
        fallbackCopy(text);
      }
    }

    function fallbackCopy(text) {
      const ta = document.createElement('textarea');
      ta.value = text;
      ta.style.position = 'fixed';
      ta.style.opacity = '0';
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      document.body.removeChild(ta);
    }
  </script>
</body>
</html>
